(function(a,b){if('function'==typeof define&&define.amd)define(['exports','../../ui-components-lite/src/utils/ui-component-base.js'],b);else if('undefined'!=typeof exports)b(exports,require('../../ui-components-lite/src/utils/ui-component-base.js'));else{var c={exports:{}};b(c.exports,a.uiComponentBase),a.gmap=c.exports}})(this,function(a,b){'use strict';function c(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function d(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function e(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}Object.defineProperty(a,'__esModule',{value:!0}),a.GoogleMap=a.mapsAPILoaded=void 0;var f=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(e===void 0){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if('value'in e)return e.value;var g=e.get;return void 0===g?void 0:g.call(d)},h=function(a){return'ArrowUp'===a||'Up'===a?38:'ArrowDown'===a||'Down'===a?40:'ArrowLeft'===a||'Left'===a?37:'ArrowRight'===a||'Right'===a?39:'Add'===a||'Equal'===a?187:'Minus'===a||'Subtract'===a?189:0},i=!1,j=a.mapsAPILoaded=function(){return new Promise(function(a){var c=b.global.setTimeout(function(){(b.document.querySelector('ui-alert')||b.global).alert('Sorry but google maps is taking longer than expected to load.\n  If this message does not disappear in the next couple of seconds please refresh the page.')},8e3),d=b.global.setTimeout(function(){(b.document.querySelector('ui-alert')||b.global).alert('Oops! Looks like Google Maps failed to load. Please refresh the page.')},15e3);b.global._resolveMapsLoader=function(){clearTimeout(c),clearTimeout(d);var e=b.document.querySelector('ui-alert');e&&e.isOpen&&e.close(),b.global.dispatchEvent(new CustomEvent('google-maps-ready')),a(!0)},b.global.google&&b.global.google.maps&&b.global.google.maps.Map&&b.global._resolveMapsLoader()})}(),k=b.document.createElement('template');k.innerHTML='\n  <style>\n    :host {\n      display: block;\n      min-width: 400px;\n      min-height: 300px;\n    }\n\n    #map-container {\n      height: 100%;\n      width: 100%;\n\n      /* This is here because with no initial content height was 0 despite the parent styles */\n      min-width: 400px;\n      min-height: 300px;\n    }\n  </style>\n  <div id="map-container"></div>\n';a.GoogleMap=(0,b.defineUIComponent)({name:'ui-google-map',template:k,reflectedAttributes:['latitude','longitude','map-type','zoom-level'],definition:function(a){function k(a){c(this,k);var b=d(this,(k.__proto__||Object.getPrototypeOf(k)).call(this));return b._mapContainer=null,b._mapObj=null,b._center=null,b._keydownHandler=null,b._API_KEY=a,b._isListeningForKeypress=!1,b}return e(k,a),f(k,[{key:'setCenter',value:function(){for(var a=arguments.length,c=Array(a),d=0;d<a;d++)c[d]=arguments[d];var e=function(){switch(c.length){case 1:return c[0];case 2:return new(Function.prototype.bind.apply(b.global.google.maps.LatLng,[null].concat(c)));default:throw new TypeError('Unrecognized arguments '+c+' to ui-google-map\'s setCenter.');}}();return this._center=e,this}},{key:'_addKeyboardHandler',value:function(){return this._isListeningForKeypress||(this._isListeningForKeypress=!0,b.document.addEventListener('keydown',this._keydownHandler)),this}},{key:'_removeKeyboardHandler',value:function(){return this._isListeningForKeypress&&(this._isListeningForKeypress=!1,b.document.removeEventListener('keydown',this._keydownHandler)),this}},{key:'init',value:function(){var a=this;g(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),'init',this).call(this);var c=this.attr('api-key')||this._API_KEY;if(!c||'YOUR_API_KEY_HERE'===c)throw new Error('No google maps API key!');if(!i){i=!0;var d=b.document.createElement('script');d.src='https://maps.googleapis.com/maps/api/js?key='+c+'&callback=_resolveMapsLoader',b.document.head.appendChild(d)}this._beforeReady(function(){return j.then(function(){a._mapContainer=a.selectInternalElement('#map-container');var c={zoom:11,center:new b.global.google.maps.LatLng(39.75,-86.16),mapTypeId:google.maps.MapTypeId.ROADMAP,keyboardShortcuts:!1};a.mapType&&a.mapType.toUpperCase()in b.global.google.maps.MapTypeId&&(c.mapTypeId=b.global.google.maps[a.mapType.toUpperCase()]),a.attr('zoom-level')?c.zoom=a.attr('zoom-level'):a.attr('zoom-level',c.zoom),a.attr('latitude')&&a.attr('longitude')?c.center=new b.global.google.maps.LatLng(a.attr('latitude'),a.attr('longitude')):(a.attr('latitude',c.center.lat()),a.attr('longitude',c.center.lng())),a._center=c.center,a._mapObj=new b.global.google.maps.Map(a._mapContainer,c),a._mapObj.addListener('zoom_changed',function(){a._center=a.map.getCenter()}),a._mapObj.addListener('dragend',function(){console.log('dragend'),a._center=a.map.getCenter()}),a._keydownHandler=function(b){var c=b.keyCode||h(b.key);107===c||187===c?a._mapObj.setZoom(a._mapObj.getZoom()+1):109===c||189===c?a._mapObj.setZoom(a._mapObj.getZoom()-1):37===c?a._mapObj.panBy(-50,0):38===c?a._mapObj.panBy(0,50):39===c?a._mapObj.panBy(50,0):40===c?a._mapObj.panBy(0,-50):void 0},a.on('mouseenter',function(){console.log('mouseenter'),a._addKeyboardHandler()}),a.on('mouseleave',function(){console.log('mouseleave'),a._removeKeyboardHandler()}),b.global.addEventListener('resize',function(){b.global.setTimeout(function(){a.map.setCenter(a._center)},0)})})})}},{key:'map',get:function(){return this._mapObj}}]),k}(b.UIBase)})});