"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GoogleMap=exports.mapsAPILoaded=void 0;var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_get=function a(b,c,d){null===b&&(b=Function.prototype);var e=Object.getOwnPropertyDescriptor(b,c);if(e===void 0){var f=Object.getPrototypeOf(b);return null===f?void 0:a(f,c,d)}if("value"in e)return e.value;var g=e.get;return void 0===g?void 0:g.call(d)},_uiComponentBase=require("../node_modules/ui-components-lite/utils/ui-component-base.js");function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"==typeof b||"function"==typeof b)?b:a}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var tooLongMessage="Sorry but google maps is taking longer than expected to load.\n  If this message does not disappear in the next couple of seconds please refresh the page.",failMessage="Oops! Looks like Google Maps failed to load. Please refresh the page.",warnTimeout=8e3,failTimeout=15e3,mapsLoaded=!1,mapsAPILoaded=exports.mapsAPILoaded=function(){return new Promise(function(a){var b=_uiComponentBase.global.setTimeout(function(){(_uiComponentBase.document.querySelector("ui-alert")||_uiComponentBase.global).alert(tooLongMessage)},warnTimeout),c=_uiComponentBase.global.setTimeout(function(){(_uiComponentBase.document.querySelector("ui-alert")||_uiComponentBase.global).alert(failMessage)},failTimeout);_uiComponentBase.global._resolveMapsLoader=function(){clearTimeout(b),clearTimeout(c);var d=_uiComponentBase.document.querySelector("ui-alert");d&&d.isOpen&&d.close(),_uiComponentBase.global.dispatchEvent(new CustomEvent("google-maps-ready")),a(!0)},_uiComponentBase.global.google&&_uiComponentBase.global.google.maps&&_uiComponentBase.global.google.maps.Map&&_uiComponentBase.global._resolveMapsLoader()})}(),template=_uiComponentBase.document.createElement("template");template.innerHTML="\n  <style>\n    :host {\n      display: block;\n      min-width: 400px;\n      min-height: 300px;\n    }\n\n    #map-container {\n      height: 100%;\n      width: 100%;\n\n      /* This is here because with no initial content height was 0 despite the parent styles */\n      min-width: 400px;\n      min-height: 300px;\n    }\n  </style>\n  <div id=\"map-container\"></div>\n";var reflectedAttrs=["latitude","longitude","map-type","zoom-level"],GoogleMap=exports.GoogleMap=(0,_uiComponentBase.defineUIComponent)({name:"ui-google-map",template:template,definition:function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return a._mapContainer=null,a._mapObj=null,a._center=null,a}return _inherits(b,a),_createClass(b,[{key:"setCenter",value:function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];var d=function(){switch(b.length){case 1:return b[0];case 2:return new(Function.prototype.bind.apply(_uiComponentBase.global.google.maps.LatLng,[null].concat(b)));default:throw new TypeError("Unrecognized arguments "+b+" to ui-google-map's setCenter.");}}();return this._center=d,this}},{key:"init",value:function(){var a=this;if(_get(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"init",this).call(this),!mapsLoaded){mapsLoaded=!0;var c=this.attr("api-key");if(!c||"YOUR_API_KEY_HERE"===c)throw new Error("No google maps API key!");var d=_uiComponentBase.document.createElement("script");d.src="https://maps.googleapis.com/maps/api/js?key="+c+"&callback=_resolveMapsLoader",_uiComponentBase.document.head.appendChild(d)}mapsAPILoaded.then(function(){a._mapContainer=a.selectInternalElement("#map-container");var b={zoom:11,center:new _uiComponentBase.global.google.maps.LatLng(39.75,-86.16),mapTypeId:google.maps.MapTypeId.ROADMAP};a.mapType&&a.mapType.toUpperCase()in _uiComponentBase.global.google.maps.MapTypeId&&(b.mapTypeId=_uiComponentBase.global.google.maps[a.mapType.toUpperCase()]),a.zoomLevel&&(b.zoom=a.zoomLevel),a.latitude&&a.longitude&&(b.center=new _uiComponentBase.global.google.maps.LatLng(a.latitude,a.longitude)),a._center=b.center,a._mapObj=new _uiComponentBase.global.google.maps.Map(a._mapContainer,b),a._mapObj.addListener("zoom_changed",function(){a._center=a.map.getCenter()}),a._mapObj.addListener("dragend",function(){a._center=a.map.getCenter()});var c=function(b){switch(b.keyCode){case 107:case 187:a._mapObj.setZoom(a._mapObj.getZoom()+1);break;case 109:case 189:a._mapObj.setZoom(a._mapObj.getZoom()-1);break;case 37:a._mapObj.panBy(-50,0);break;case 38:a._mapObj.panBy(0,50);break;case 39:a._mapObj.panBy(50,0);break;case 40:a._mapObj.panBy(0,-50);}};a.on("mouseenter",function(){_uiComponentBase.document.addEventListener("keydown",c)}),a.on("mouseleave",function(){_uiComponentBase.document.removeEventListener("keydown",c)}),_uiComponentBase.global.addEventListener("resize",function(){_uiComponentBase.global.setTimeout(function(){a.map.setCenter(a._center)},0)})})}},{key:"map",get:function(){return this._mapObj}}]),b}(_uiComponentBase.UIBase)});